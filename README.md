# Many-to-Many Relationship in ASP.NET Core

## What is a Many-to-Many Relationship?

A **Many-to-Many (M:N) relationship** is a database relationship where multiple records in one table can be associated with multiple records in another table. This type of relationship requires a **junction table** (also called a join table or bridge table) to connect the two tables.

### Key Characteristics:
- One record in Table A can relate to many records in Table B
- One record in Table B can relate to many records in Table A
- Requires a junction/join table to implement the relationship

## Real-World Example: Students and Courses

Imagine a university system:
- A **Student** can enroll in **multiple Courses**
- A **Course** can have **multiple Students** enrolled

This is a perfect example of a many-to-many relationship:
```
Student John ? enrolled in ? [Math 101, Physics 201, Chemistry 301]
Student Mary ? enrolled in ? [Physics 201, Biology 101, Chemistry 301]

Course Physics 201 ? has students ? [John, Mary, Peter]
Course Chemistry 301 ? has students ? [John, Mary, Sarah]
```

## Project Implementation

This project demonstrates a many-to-many relationship using:
- **ASP.NET Core 8.0**
- **Entity Framework Core**
- **SQL Server Database**

### Entities

#### 1. Student Entity
```csharp
public class Student
{
    public Guid Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string Email { get; set; }
    public DateTime EnrollmentDate { get; set; }
    
    // Navigation property for many-to-many relationship
    public ICollection<Course> Courses { get; set; }
}
```

#### 2. Course Entity
```csharp
public class Course
{
    public Guid Id { get; set; }
    public string CourseCode { get; set; }
    public string CourseName { get; set; }
    public string Description { get; set; }
    public int Credits { get; set; }
    
    // Navigation property for many-to-many relationship
    public ICollection<Student> Students { get; set; }
}
```

### Database Configuration

In **Entity Framework Core 5.0+**, many-to-many relationships are automatically handled. EF Core creates a join table behind the scenes.

```csharp
protected override void OnModelCreating(ModelBuilder modelBuilder)
{
    // Configure Many-to-Many relationship
    modelBuilder.Entity<Student>()
        .HasMany(s => s.Courses)
        .WithMany(c => c.Students)
        .UsingEntity(j => j.ToTable("StudentCourses"));
}
```

### Database Schema

The implementation creates three tables:

1. **Students Table**
   - Id (Primary Key)
   - FirstName
   - LastName
   - Email
   - EnrollmentDate

2. **Courses Table**
   - Id (Primary Key)
   - CourseCode
   - CourseName
   - Description
   - Credits

3. **StudentCourses Table** (Junction Table - Auto-generated by EF Core)
   - StudentsId (Foreign Key to Students)
   - CoursesId (Foreign Key to Courses)
   - Composite Primary Key (StudentsId, CoursesId)

## How to Run the Project

### Prerequisites
- .NET 8.0 SDK
- SQL Server or SQL Server Express
- Visual Studio 2022 or VS Code

### Steps

1. **Clone the repository**
   ```bash
   git clone <your-repository-url>
   cd WebApplication1
   ```

2. **Update the connection string**
   
   Update the connection string in `appsettings.json` or `Program.cs`

3. **Create and apply migrations**
   ```bash
   dotnet ef migrations add AddStudentCourseManyToMany
   dotnet ef database update
   ```

4. **Run the application**
   ```bash
   dotnet run
   ```

## Usage Examples

### Adding a Student with Courses
```csharp
var student = new Student
{
    FirstName = "John",
    LastName = "Doe",
    Email = "john.doe@university.edu",
    EnrollmentDate = DateTime.Now
};

var course1 = new Course
{
    CourseCode = "CS101",
    CourseName = "Introduction to Programming",
    Credits = 3
};

var course2 = new Course
{
    CourseCode = "MATH201",
    CourseName = "Calculus I",
    Credits = 4
};

student.Courses.Add(course1);
student.Courses.Add(course2);

context.Students.Add(student);
context.SaveChanges();
```

### Querying Students with Their Courses
```csharp
var studentsWithCourses = context.Students
    .Include(s => s.Courses)
    .ToList();

foreach (var student in studentsWithCourses)
{
    Console.WriteLine($"{student.FirstName} {student.LastName}");
    foreach (var course in student.Courses)
    {
        Console.WriteLine($"  - {course.CourseCode}: {course.CourseName}");
    }
}
```

### Querying Courses with Their Students
```csharp
var coursesWithStudents = context.Courses
    .Include(c => c.Students)
    .ToList();

foreach (var course in coursesWithStudents)
{
    Console.WriteLine($"{course.CourseCode}: {course.CourseName}");
    Console.WriteLine($"Enrolled Students: {course.Students.Count}");
}
```
